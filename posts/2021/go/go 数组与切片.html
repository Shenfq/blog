<!doctype html><html class="" data-reactroot=""><head><script src="/assets/hm.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/>
<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="description" content="前端工程师，爱折腾，擅长 JavaScript，欢迎关注我的公众号「更了不起的前端」"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/>
<title data-react-helmet="true">Go 数组与切片 · 自然醒的博客</title>
<link data-react-helmet="true" rel="stylesheet" href="/assets/index.css"/><link data-react-helmet="true" id="prismTheme" rel="stylesheet" href="/assets/prism.css"/>
<script data-react-helmet="true" >
    const shouldSetIsDark = document.cookie.includes('is_dark=1') ? true : document.cookie.includes('is_dark=0') ? false : window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (shouldSetIsDark) {
      document.documentElement.classList.add('is_dark');
      document.getElementById('prismTheme').href = "/assets/prism_tomorrow.css";
    }
  </script>
</head><body><a class="czs-menu-l show_on_mobile aside_button_open" href="#" style="background-image:url(&quot;/assets/czs-menu-l.svg&quot;)"></a><a class="show_on_mobile aside_button_text" href="/">自然醒的博客</a><aside class="hide_on_mobile"><div class="aside_card"><a class="czs-menu-l show_on_mobile aside_button_close" href="#" style="background-image:url(&quot;/assets/czs-close-l.svg&quot;)"></a><h1><a href="/">自然醒的博客</a></h1><p class="description">前端工程师，爱折腾，擅长 JavaScript，欢迎关注我的公众号「更了不起的前端」</p><ul class="social list_style_none"><li class="flex_center"><a class="czs-github-logo" href="https://github.com/Shenfq" target="_blank" style="background-image:url(&quot;/assets/czs-github-logo.svg&quot;)"></a></li><li class="flex_center"><a class="czs-message-l" href="mailto:shenfq95@foxmail.com" target="_blank" style="background-image:url(&quot;/assets/czs-message-l.svg&quot;)"></a></li><li style="flex-grow:1"></li><li class="toggle_dark flex_center"><span class="czs-sun" style="background-image:url(&quot;/assets/czs-sun.svg&quot;)"></span><span class="czs-sun-l" style="background-image:url(&quot;/assets/czs-sun-l.svg&quot;)"></span><span class="czs-moon" style="background-image:url(&quot;/assets/czs-moon.svg&quot;)"></span><span class="czs-moon-l" style="background-image:url(&quot;/assets/czs-moon-l.svg&quot;)"></span></li></ul><nav><ul class="menu list_style_none"><li><a class="flex_center" href="/"><span class="czs-home-l" style="background-image:url(&quot;/assets/czs-home-l.svg&quot;)"></span>首页</a></li><li><a class="flex_center" href="/categories/"><span class="czs-category-l" style="background-image:url(&quot;/assets/czs-category-l.svg&quot;)"></span>分类</a></li><li><a class="flex_center" href="/tags/"><span class="czs-tag-l" style="background-image:url(&quot;/assets/czs-tag-l.svg&quot;)"></span>标签</a></li><li><a class="flex_center" href="/about/"><span class="czs-about-l" style="background-image:url(&quot;/assets/czs-about-l.svg&quot;)"></span>关于</a></li><li><a class="flex_center" href="/archives/"><span class="czs-box-l" style="background-image:url(&quot;/assets/czs-box-l.svg&quot;)"></span>归档</a></li><li><a class="flex_center" href="/links/index.html"><span class="czs-link-l" style="background-image:url(&quot;/assets/czs-link-l.svg&quot;)"></span>友情链接</a></li></ul></nav></div><nav class="toc"><ol><li><a href="#%E6%95%B0%E7%BB%84">数组</a><ol><li><a href="#%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96">数组初始化</a><ol></ol></li><li><a href="#%E8%B5%8B%E5%80%BC%E4%B8%8E%E8%AE%BF%E9%97%AE">赋值与访问</a></li><li><a href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84">多维数组</a></li></ol></li><li><a href="#%E5%88%87%E7%89%87">切片</a><ol><li><a href="#%E5%88%87%E7%89%87%E5%88%9D%E5%A7%8B%E5%8C%96">切片初始化</a></li><li><a href="#%E9%95%BF%E5%BA%A6%E4%B8%8E%E5%AE%B9%E9%87%8F">长度与容量</a></li><li><a href="#%E5%88%87%E7%89%87%E6%88%AA%E5%8F%96">切片截取</a></li></ol></li></ol></nav></aside><section class="main"><h1>Go 数组与切片</h1><div class="main_post_meta"><time dateTime="2021/04/08">2021-04-08</time> · <!-- -->shenfq</div><article><h2 id="%E6%95%B0%E7%BB%84">数组<a class="anchor" href="#%E6%95%B0%E7%BB%84">§</a></h2>
<p>数组是一组类型相同的，长度固定的，按数字编号排列的数据序列。由于 go 语言中，数组的类型相同且长度固定，所以在声明数组的时候，就会体现这两个特点。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// [0 0 0 0 0]</span>
</code></pre>
<p>数组通过 <code>[SIZE]（方括号内为数组长度）</code> 加上 <code>TYPE（类型）</code> 的形式声明，上面的代码就表示 <code>array</code> 变量为一个长度为 <code>5</code>，且五个数据的类型都为 <code>int</code>。</p>
<p>在之前介绍变量的时候，介绍过 <code>int</code> 类型的默认值为 <code>0</code>，所以 <code>array</code> 的值为 <code>[0 0 0 0 0]</code>。</p>
<h3 id="%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96">数组初始化<a class="anchor" href="#%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96">§</a></h3>
<p>数组在初始化阶段，需要通过 <code>{}</code> 的方式，指定数组每个位置的具体值。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token comment">// [1 2 3]</span>
</code></pre>
<p>可以看到 <code>{}</code> 的前面也要带上数组的长度与类型，由于 go 能够进行类型推导，变量后声明的类型显得有点多余，是可以省略的。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token comment">// [1 2 3]</span>
</code></pre>
<h4 id="%F0%9F%8E%B6-%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95%E8%B5%8B%E5%80%BC">🎶 指定索引赋值<a class="anchor" href="#%F0%9F%8E%B6-%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95%E8%B5%8B%E5%80%BC">§</a></h4>
<p>初始化的过程中，我们还可以指定索引进行赋值，也就是不必给数组的每个位置都安排上具体的值。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">}</span> <span class="token comment">// [0 77 0 77 0]</span>
</code></pre>
<p>上面的数组输出的结果为：<code>[0 77 0 77 0]</code>。和其他语言一样，数组的索引是从 <code>0</code> 开始的，我们给索引为 <code>1</code> 和 <code>3</code> 位置都指定了值为 <code>77</code> ，其他位置由于没有指定具体值，就是其类型的默认值。</p>
<h4 id="%F0%9F%8E%B6-%E8%87%AA%E5%8A%A8%E6%8E%A8%E5%AF%BC%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6">🎶 自动推导数组长度<a class="anchor" href="#%F0%9F%8E%B6-%E8%87%AA%E5%8A%A8%E6%8E%A8%E5%AF%BC%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6">§</a></h4>
<p>前面的案例都是指定了数组的长度，其实我们可以通过 <code>[...]</code> 的方式，告诉 go 编译器，数组长度尚未确定，在初始化之后才能确定其长度，然后 go 在编译阶段就会自动进行推导。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span> <span class="token comment">// [1 2 3 4 5]</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"array length is"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>我们可以通过 <code>len</code> 方法获取数组的长度</strong>，上面代码的运行结果如下：</p>
<p><img src="https://file.shenfq.com/pic/20210407195942.png" alt=""></p>
<p>如果我们在指定索引的位置赋值了，最终长度取决于最末尾的索引，下面的代码中，指定了索引 <code>5</code> 的值为 <code>77</code>，则数组的长度为 <code>6</code>。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">77</span><span class="token punctuation">}</span> <span class="token comment">// [0 77 0 0 0 77]</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"array length is"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210407200247.png" alt=""></p>
<h3 id="%E8%B5%8B%E5%80%BC%E4%B8%8E%E8%AE%BF%E9%97%AE">赋值与访问<a class="anchor" href="#%E8%B5%8B%E5%80%BC%E4%B8%8E%E8%AE%BF%E9%97%AE">§</a></h3>
<p>与其他语言一样，数组的赋值和访问都是通过 <code>[Index]</code> 操作的。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span> <span class="token comment">// 索引 0 的位置重新赋值为 100</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"array is"</span><span class="token punctuation">,</span> array<span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210407202513.png" alt=""></p>
<p>取值也是同样的操作，我们现在实现一个求数组平均数的函数：</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">getAverage</span><span class="token punctuation">(</span>array <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">float32</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> sum <span class="token builtin">int</span>
	<span class="token keyword">var</span> avg <span class="token builtin">float32</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		sum <span class="token operator">+=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>

	avg <span class="token operator">=</span> <span class="token function">float32</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">5</span>

	<span class="token keyword">return</span> avg
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"average is"</span><span class="token punctuation">,</span> <span class="token function">getAverage</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210407205141.png" alt=""></p>
<h3 id="%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84">多维数组<a class="anchor" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84">§</a></h3>
<p>多维数组的声明，相对于一维数组，就是看前面有几个 <code>[SIZE]</code>。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> a1 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// 二维数组</span>
<span class="token keyword">var</span> a1 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// 三维数组</span>
</code></pre>
<p>我们拿三维数组举例，第一个 <code>[]</code>  内的数字表示最外层数组的长度，往后以此类推。<code>[2][3][4]int</code> 表示最外层数组长度为 2，第二层数组长度为 3，最内层数组长度为 4。其赋值方式也和一维数组一样，只是多维数组需要将多个 <code>{}</code> 进行嵌套。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> a1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
</code></pre>
<p>打印结果：</p>
<p><img src="https://file.shenfq.com/pic/20210407210214.png" alt=""></p>
<p>多维数组的访问和一维数组一样，也是通过 <code>[]</code> + 数组索引，只是多维数组要访问某个值需要多个 <code>[]</code>。</p>
<p>如果我们要拿到下图的 <code>2</code>，访问方式为：<code>array[0][1][1]</code></p>
<p><img src="https://file.shenfq.com/pic/20210407210706.png" alt=""></p>
<pre class="language-go"><code class="language-go">fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"array[0][1][1] = "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210407210809.png" alt=""></p>
<h2 id="%E5%88%87%E7%89%87">切片<a class="anchor" href="#%E5%88%87%E7%89%87">§</a></h2>
<p>前面介绍过，数组是一组类型相同且长度固定的数据集合，而切片就是一种比较抽象的数组，其长度不固定，声明方式与数组类似（<code>[]</code> 中不显示注明数组长度，也不使用 <code>[...]</code> 的方式进行长度的推导）：</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> slice <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
</code></pre>
<h3 id="%E5%88%87%E7%89%87%E5%88%9D%E5%A7%8B%E5%8C%96">切片初始化<a class="anchor" href="#%E5%88%87%E7%89%87%E5%88%9D%E5%A7%8B%E5%8C%96">§</a></h3>
<p>切片的初始化与数组类似，只要省略掉 <code>[]</code> 内注明的数组长度即可：</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
s2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> <span class="token comment">// 简写</span>
</code></pre>
<p>除了这种字面量的声明方式，还可以通过 go 的内置方法：<code>make</code>，来进行切片的初始化：</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
s2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 简写</span>
</code></pre>
<p><code>make</code> 方法的第二个参数表示切片的长度，虽然切片的长度可变，但是通过 <code>make</code> 方法创建切片时，需要指定一个长度。除了指定切片的长度，<code>make</code> 方法还支持传入第三个参数，用来指定切片的『容量』，如果没有指定切片的容量，那初始状态切片的容量与长度一致。</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>T<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">,</span> <span class="token builtin">cap</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="%E9%95%BF%E5%BA%A6%E4%B8%8E%E5%AE%B9%E9%87%8F">长度与容量<a class="anchor" href="#%E9%95%BF%E5%BA%A6%E4%B8%8E%E5%AE%B9%E9%87%8F">§</a></h3>
<p>长度指的是，切片内有多少个元素，而容量可以理解为，当前切片在内存中开辟了多大的空间。前面介绍过，可以通过 <code>len</code> 方法获取到数组的长度，获取切片的长度也可以使用该方法。要获取切片的容量，可以使用 <code>cap</code> 方法。</p>
<pre class="language-go"><code class="language-go">s1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The length of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The capacity of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408143245.png" alt=""></p>
<p>可以看到初始状态下，切片的长度与容量一致。如果要修改切片的长度，可以通过 <code>append</code> 方法，在切片尾部追加一个新的值。</p>
<pre class="language-go"><code class="language-go">s1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// 声明一个长度为 3，容量为 5 的切面</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 在尾部追加一个值，长度会变成 4</span>

fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The length of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The capacity of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408143937.png" alt=""></p>
<p><code>append</code> 方法是可以接受多个参数，我们在追加一个值之后，继续调用 <code>append</code> 方法，往切片后再追加两个值：</p>
<pre class="language-go"><code class="language-go">s1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">// [0 0 0 1 2 3]</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The length of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The capacity of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>此时的切片的长度已经变成了 6，超过了切片的容量，那这个时候切换的容量会不会也变成 6？</p>
<p><img src="https://file.shenfq.com/pic/20210408144255.png" alt=""></p>
<p>根据输出的结果，此时切片的容量变成了 10，这意味着切片的容量的扩充是在之前的基础长进行翻倍操作的。为了验证这个结论，我们在切片后继续追加 5 个值，让切片的长度变成 11，超出当前的容量，看看容量会变成多少。</p>
<pre class="language-go"><code class="language-go">s1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>

fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The length of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The capacity of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408144603.png" alt=""></p>
<p>可以看到切片的容量变成了 20，这也验证了我们之前的结论，当切片长度超过了其容量，容量会在原来的基础上翻倍。那如果切片容量达到了 2000，长度超过 2000，容量也会变成 4000 吗？</p>
<pre class="language-go"><code class="language-go">s1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"\nThe length of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"The capacity of s1 is %d\n"</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408144937.png" alt=""></p>
<p>可以看到，我们新定义的切片长度为 1024，在长度变成 1025 的时候，容量并没有翻倍。为了避免切片容量无休止的扩展，go 规定如果当前切片的长度大于 1024 ，在长度超过其容量时，只会增加 25% 的容量。</p>
<h3 id="%E5%88%87%E7%89%87%E6%88%AA%E5%8F%96">切片截取<a class="anchor" href="#%E5%88%87%E7%89%87%E6%88%AA%E5%8F%96">§</a></h3>
<p>切片之所以叫切片，是因为它可以通过切出数组中的某一块来创建。语法规则也很简单：<code>Array[start:end]</code>。</p>
<pre class="language-go"><code class="language-go">arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
slice <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span> <span class="token comment">// [2 3]</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408151709.png" alt=""></p>
<p><code>arr[1:3]</code> 表示将数组的从索引为 1 的位置一直到索引为 3 的位置（不包括 3）截取出来，形成一个切片。当然这个开头结尾的数字也是可以省略的，如果我们如果我们省略开头就表示截取开始的位置为 0，省略结尾就表示截取结束的位置一直到数组的最后一位。</p>
<pre class="language-go"><code class="language-go">arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
slice <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span> <span class="token comment">// [2 3 4 5]</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408152153.png" alt=""></p>
<p>通过省略截取的开头和结尾，我们就能将一个数组进行一次拷贝操作，然后形成一个切片。（PS. 截取操作形成的新数据是一个切片）</p>
<pre class="language-go"><code class="language-go">arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
slice <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"slice = %v, slice type is %T"</span><span class="token punctuation">,</span> slice<span class="token punctuation">,</span> slice<span class="token punctuation">)</span>
</code></pre>
<p><img src="https://file.shenfq.com/pic/20210408152646.png" alt=""></p></article></section><footer>Powered by <a href="https://github.com/xcatliu/pagic" target="_blank">Pagic</a></footer><script src="https://cdn.pagic.org/react@16.13.1/umd/react.production.min.js"></script><script src="https://cdn.pagic.org/react-dom@16.13.1/umd/react-dom.production.min.js"></script><script type="module" src="/index.js"></script></body></html>