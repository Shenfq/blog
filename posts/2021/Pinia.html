<!doctype html><html class="" data-reactroot=""><head><script src="/assets/hm.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/>
<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="description" content="å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçˆ±æŠ˜è…¾ï¼Œæ“…é•¿ JavaScriptï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œè‡ªç„¶é†’çš„ç¬”è®°æœ¬ã€"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/>
<title data-react-helmet="true">å…¨æ–°çš„ Vue3 çŠ¶æ€ç®¡ç†å·¥å…·ï¼šPinia Â· è‡ªç„¶é†’çš„åšå®¢</title>
<link data-react-helmet="true" rel="stylesheet" href="/assets/index.css"/><link data-react-helmet="true" id="prismTheme" rel="stylesheet" href="/assets/prism.css"/>
<script data-react-helmet="true" >
    const shouldSetIsDark = document.cookie.includes('is_dark=1') ? true : document.cookie.includes('is_dark=0') ? false : window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (shouldSetIsDark) {
      document.documentElement.classList.add('is_dark');
      document.getElementById('prismTheme').href = "/assets/prism_tomorrow.css";
    }
  </script>
</head><body><a class="czs-menu-l show_on_mobile aside_button_open" href="#" style="background-image:url(&quot;/assets/czs-menu-l.svg&quot;)"></a><a class="show_on_mobile aside_button_text" href="/">è‡ªç„¶é†’çš„åšå®¢</a><aside class="hide_on_mobile"><div class="aside_card"><a class="czs-menu-l show_on_mobile aside_button_close" href="#" style="background-image:url(&quot;/assets/czs-close-l.svg&quot;)"></a><h1><a href="/">è‡ªç„¶é†’çš„åšå®¢</a></h1><p class="description">å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçˆ±æŠ˜è…¾ï¼Œæ“…é•¿ JavaScriptï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œè‡ªç„¶é†’çš„ç¬”è®°æœ¬ã€</p><ul class="social list_style_none"><li class="flex_center"><a class="czs-github-logo" href="https://github.com/Shenfq" target="_blank" style="background-image:url(&quot;/assets/czs-github-logo.svg&quot;)"></a></li><li class="flex_center"><a class="czs-message-l" href="mailto:shenfq95@foxmail.com" target="_blank" style="background-image:url(&quot;/assets/czs-message-l.svg&quot;)"></a></li><li style="flex-grow:1"></li><li class="toggle_dark flex_center"><span class="czs-sun" style="background-image:url(&quot;/assets/czs-sun.svg&quot;)"></span><span class="czs-sun-l" style="background-image:url(&quot;/assets/czs-sun-l.svg&quot;)"></span><span class="czs-moon" style="background-image:url(&quot;/assets/czs-moon.svg&quot;)"></span><span class="czs-moon-l" style="background-image:url(&quot;/assets/czs-moon-l.svg&quot;)"></span></li></ul><nav><ul class="menu list_style_none"><li><a class="flex_center" href="/"><span class="czs-home-l" style="background-image:url(&quot;/assets/czs-home-l.svg&quot;)"></span>é¦–é¡µ</a></li><li><a class="flex_center" href="/categories/"><span class="czs-category-l" style="background-image:url(&quot;/assets/czs-category-l.svg&quot;)"></span>åˆ†ç±»</a></li><li><a class="flex_center" href="/tags/"><span class="czs-tag-l" style="background-image:url(&quot;/assets/czs-tag-l.svg&quot;)"></span>æ ‡ç­¾</a></li><li><a class="flex_center" href="/about/"><span class="czs-about-l" style="background-image:url(&quot;/assets/czs-about-l.svg&quot;)"></span>å…³äº</a></li><li><a class="flex_center" href="/archives/"><span class="czs-box-l" style="background-image:url(&quot;/assets/czs-box-l.svg&quot;)"></span>å½’æ¡£</a></li><li><a class="flex_center" href="/links/index.html"><span class="czs-link-l" style="background-image:url(&quot;/assets/czs-link-l.svg&quot;)"></span>å‹æƒ…é“¾æ¥</a></li></ul></nav></div><nav class="toc"><ol><li><a href="#%E5%AE%89%E8%A3%85">å®‰è£…</a></li><li><a href="#%E4%B8%8A%E6%89%8B">ä¸Šæ‰‹</a><ol><li><a href="#%E5%AE%9A%E4%B9%89-store">å®šä¹‰ Store</a></li><li><a href="#%E4%BD%BF%E7%94%A8-store">ä½¿ç”¨ Store</a><ol></ol></li><li><a href="#%E7%B1%BB%E5%9E%8B%E6%8F%90%E7%A4%BA">ç±»å‹æç¤º</a></li><li><a href="#%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2">ä»£ç åˆ†å‰²</a></li></ol></li></ol></nav></aside><section class="main"><h1>å…¨æ–°çš„ Vue3 çŠ¶æ€ç®¡ç†å·¥å…·ï¼šPinia</h1><div class="main_post_meta"><time dateTime="2021/12/15">2021-12-15</time> Â· <!-- -->shenfq</div><article><p>Vue3 å‘å¸ƒå·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå®ƒé‡‡ç”¨äº†æ–°çš„å“åº”å¼ç³»ç»Ÿï¼Œè€Œä¸”æ„å»ºäº†ä¸€å¥—å…¨æ–°çš„ <code>Composition API</code>ã€‚Vue çš„å‘¨è¾¹ç”Ÿæ€éƒ½åœ¨åŠ ç´§é€‚é…è¿™å¥—æ–°çš„ç³»ç»Ÿï¼Œå®˜æ–¹çš„çŠ¶æ€ç®¡ç†åº“ Vuex ä¹Ÿåœ¨é€‚é…ä¸­ï¼Œä¸ºæ­¤å®˜æ–¹æå‡ºäº†ä¸€ä¸ª <a href="https://github.com/vuejs/rfcs/discussions/270">Vuex 5</a> çš„å…¨æ–°ææ¡ˆã€‚</p>
<p><img src="https://file.shenfq.com/pic/202112151621995.png" alt=""></p>
<ul>
<li>æ”¯æŒä¸¤ç§è¯­æ³•åˆ›å»º Storeï¼š<code>Options Api</code> å’Œ <code>Composition Api</code>ï¼›</li>
<li>åˆ é™¤ <code>mutations</code>ï¼Œåªæ”¯æŒ <code>state</code>ã€<code>getters</code>ã€<code>actions</code>ï¼›</li>
<li>æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œèƒ½å¾ˆå¥½æ”¯æŒä»£ç åˆ†å‰²ï¼›</li>
<li>æ²¡æœ‰åµŒå¥—çš„æ¨¡å—ï¼Œåªæœ‰ Store çš„æ¦‚å¿µï¼›</li>
<li>å®Œæ•´çš„ <code>TypeScript</code> æ”¯æŒï¼›</li>
</ul>
<p>åœ¨è¿™ä¸ªææ¡ˆä¸‹æ–¹ï¼Œæœ‰ä¸ªè¯„è®ºå¾ˆæœ‰æ„æ€ã€‚ç®€å•ç¿»è¯‘ä¸€ä¸‹ï¼š</p>
<p><img src="https://file.shenfq.com/pic/202112151708483.png" alt=""></p>
<p>å¥½å·§ä¸å·§ï¼ŒVuex5 çš„ææ¡ˆï¼Œä¸ Pinia å®ç°çš„åŠŸèƒ½ä¸èƒ½è¯´æ¯«æ— å…³ç³»ï¼Œåªèƒ½è¯´ä¸€æ¨¡ä¸€æ ·ï¼Œä»Šå¤©çš„æ–‡ç« å°±æ¥ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹è¿™ä¸ªè èï¼š</p>
<p><img src="https://file.shenfq.com/pic/202112151708176.svg" alt="Logo"></p>
<h2 id="%E5%AE%89%E8%A3%85">å®‰è£…<a class="anchor" href="#%E5%AE%89%E8%A3%85">Â§</a></h2>
<p>åœ¨ç°æœ‰é¡¹ç›®ä¸­ï¼Œç”¨è¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œ Pinia æ¨¡å—çš„å®‰è£…ã€‚</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># yarn</span>
<span class="token function">yarn</span> <span class="token function">add</span> <a class="token email-link" href="mailto:pinia@next">pinia@next</a>
<span class="token comment"># npm</span>
<span class="token function">npm</span> i <a class="token email-link" href="mailto:pinia@next">pinia@next</a>
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œéœ€è¦åœ¨ Vue3 é¡¹ç›®çš„å…¥å£æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œå¯¼å…¥å®‰è£…ã€‚</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// main.js</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createApp <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vue'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'pinia'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App.vue'</span>

<span class="token comment">// å®ä¾‹åŒ– Vue</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token maybe-class-name">App</span><span class="token punctuation">)</span>
<span class="token comment">// å®‰è£… Pinia</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// æŒ‚è½½åœ¨çœŸå® DOM</span>
app<span class="token punctuation">.</span><span class="token method function property-access">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="%E4%B8%8A%E6%89%8B">ä¸Šæ‰‹<a class="anchor" href="#%E4%B8%8A%E6%89%8B">Â§</a></h2>
<p>è¦ä½¿ç”¨ Pinia çš„è¯ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ª storeï¼Œç„¶ååœ¨ç”¨åˆ°è¯¥æ•°æ®çš„åœ°æ–¹è¿›è¡Œå¯¼å…¥ã€‚</p>
<h3 id="%E5%AE%9A%E4%B9%89-store">å®šä¹‰ Store<a class="anchor" href="#%E5%AE%9A%E4%B9%89-store">Â§</a></h3>
<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"pinia"</span>

<span class="token comment">// å¯¹å¤–éƒ¨æš´éœ²ä¸€ä¸ª use æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯¼å‡ºæˆ‘ä»¬å®šä¹‰çš„ state</span>
<span class="token keyword">const</span> useCounterStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// æ¯ä¸ª store çš„ id å¿…é¡»å”¯ä¸€</span>
  id<span class="token operator">:</span> <span class="token string">'counter'</span><span class="token punctuation">,</span>
  <span class="token comment">// state è¡¨ç¤ºæ•°æ®æº</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// getters ç±»ä¼¼äº computedï¼Œå¯å¯¹ state çš„å€¼è¿›è¡ŒäºŒæ¬¡è®¡ç®—</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">double</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment">// getter ä¸­çš„ this æŒ‡å‘ğŸ‘‰ state</span>
    	<span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">count</span> <span class="token operator">*</span> <span class="token number">2</span>
  	<span class="token punctuation">}</span><span class="token punctuation">,</span>
  	<span class="token comment">// å¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´ this æŒ‡å‘æœ‰é—®é¢˜</span>
  	<span class="token comment">// å¯ä»¥åœ¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æ‹¿åˆ° state</span>
    <span class="token function-variable function">double</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    	<span class="token keyword control-flow">return</span> state<span class="token punctuation">.</span><span class="token property-access">count</span> <span class="token operator">*</span> <span class="token number">2</span>
  	<span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// actions ç”¨æ¥ä¿®æ”¹ state</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// action ä¸­çš„ this æŒ‡å‘ğŸ‘‰ state</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">count</span><span class="token operator">++</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> useCounterStore
</code></pre>
<p>é™¤äº†ä½¿ç”¨ä¸Šè¿°ç±»ä¼¼ vuex çš„æ–¹å¼æ¥æ„å»º stateï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>function</code> çš„å½¢å¼æ¥åˆ›å»º storeï¼Œæœ‰ç‚¹ç±»ä¼¼äº Vue3 ä¸­çš„ <code>setup()</code>ã€‚</p>
<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> ref<span class="token punctuation">,</span> computed <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"vue"</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"pinia"</span>

<span class="token comment">// å¯¹å¤–éƒ¨æš´éœ²ä¸€ä¸ª use æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯¼å‡ºæˆ‘ä»¬å®šä¹‰çš„ state</span>
<span class="token keyword">const</span> useCounterStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> double <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> count<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
  	count<span class="token punctuation">,</span> double<span class="token punctuation">,</span> increment
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> useCounterStore
</code></pre>
<h3 id="%E4%BD%BF%E7%94%A8-store">ä½¿ç”¨ Store<a class="anchor" href="#%E4%BD%BF%E7%94%A8-store">Â§</a></h3>
<p>å‰é¢ä¹Ÿä»‹ç»è¿‡ï¼ŒPinia æä¾›äº†ä¸¤ç§æ–¹å¼æ¥ä½¿ç”¨ storeï¼Œ<code>Options Api</code> å’Œ <code>Composition Api</code> ä¸­éƒ½å®Œç¾æ”¯æŒã€‚</p>
<h4 id="options-api">Options Api<a class="anchor" href="#options-api">Â§</a></h4>
<p>åœ¨ <code>Options Api</code> ä¸­ï¼Œå¯ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ <code>mapActions</code> å’Œ <code>mapState</code> æ–¹æ³•ï¼Œå¯¼å‡º store ä¸­çš„ stateã€getterã€actionï¼Œå…¶ç”¨æ³•ä¸ Vuex åŸºæœ¬ä¸€è‡´ï¼Œå¾ˆå®¹æ˜“ä¸Šæ‰‹ã€‚</p>
<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> mapActions<span class="token punctuation">,</span> mapState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'pinia'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useCounterStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'../model/counter'</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token spread operator">...</span><span class="token method function property-access">mapState</span><span class="token punctuation">(</span>useCounterStore<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token string">'double'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token spread operator">...</span><span class="token method function property-access">mapActions</span><span class="token punctuation">(</span>useCounterStore<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'increment'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="composition-api">Composition Api<a class="anchor" href="#composition-api">Â§</a></h4>
<p><code>Composition Api</code> ä¸­ï¼Œä¸ç®¡æ˜¯ state è¿˜æ˜¯ getter éƒ½éœ€è¦é€šè¿‡ <code>computed</code> æ–¹æ³•æ¥ç›‘å¬å˜åŒ–ï¼Œè¿™å’Œ <code>Options Api</code> ä¸­ï¼Œéœ€è¦æ”¾åˆ° <code>computed</code> å¯¹è±¡ä¸­çš„é“ç†ä¸€æ ·ã€‚å¦å¤–ï¼Œ <code>Options Api</code>  ä¸­æ‹¿åˆ°çš„ state å€¼æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹æ“ä½œçš„ï¼Œå½“ç„¶è¿˜æ˜¯å»ºè®®å†™ä¸€ä¸ª action æ¥æ“ä½œ state å€¼ï¼Œæ–¹ä¾¿åæœŸç»´æŠ¤ã€‚</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Composition Api</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> computed <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'vue'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useCounterStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'../stores/counter'</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'HelloWorld'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">useCounterStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// state å’Œ getter éƒ½éœ€è¦åœ¨ä½¿ç”¨ computedï¼Œè¿™å’Œ Options Api ä¸€æ ·</span>
      count<span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> counter<span class="token punctuation">.</span><span class="token property-access">count</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      double<span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> counter<span class="token punctuation">.</span><span class="token property-access">double</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span> counter<span class="token punctuation">.</span><span class="token property-access">count</span><span class="token operator">++</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// å¯ä»¥ç›´æ¥ä¿®æ”¹ state çš„å€¼</span>
      increment<span class="token operator">:</span> counter<span class="token punctuation">.</span><span class="token property-access">increment</span><span class="token punctuation">,</span> <span class="token comment">// å¯ä»¥å¼•ç”¨ store ä¸­å®šä¹‰çš„ action</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="%E7%B1%BB%E5%9E%8B%E6%8F%90%E7%A4%BA">ç±»å‹æç¤º<a class="anchor" href="#%E7%B1%BB%E5%9E%8B%E6%8F%90%E7%A4%BA">Â§</a></h3>
<p>åœ¨ Vuex ä¸­ï¼ŒTypeScript çš„ç±»å‹æç¤ºåšå¾—ä¸æ˜¯å¾ˆå¥½ï¼Œåœ¨è¿›è¡Œç±»å‹æ¨å¯¼æ—¶ï¼Œåªèƒ½æ‰¾åˆ°å®ƒçš„ stateã€‚ç‰¹åˆ«æ˜¯å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œä»£ç æç¤ºå°±å¾ˆä¸æ™ºèƒ½ã€‚</p>
<p><img src="https://file.shenfq.com/pic/202112151709157.png" alt=""></p>
<p>è€Œ piniaï¼Œå°±èƒ½æ¨å¯¼å‡ºå®šä¹‰çš„æ‰€æœ‰ stateã€getterã€actionï¼Œè¿™æ ·åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œå°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<p><img src="https://file.shenfq.com/pic/202112151709804.png" alt=""></p>
<p><img src="https://file.shenfq.com/pic/202112151709469.png" alt=""></p>
<p>ä¸»è¦æ˜¯ pinia é€šè¿‡ TypeScript è¿›è¡Œäº†ååˆ†å‹å¥½çš„ç±»å‹å®šä¹‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹ pinia çš„ç±»å‹å®šä¹‰æ–‡ä»¶ï¼ˆ<code>pinia.d.ts</code>ï¼‰ï¼š</p>
<p><img src="https://file.shenfq.com/pic/202112151709919.png" alt=""></p>
<h3 id="%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2">ä»£ç åˆ†å‰²<a class="anchor" href="#%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2">Â§</a></h3>
<p>ç”±äºä½¿ç”¨äº†æ¨¡å—åŒ–è®¾è®¡ï¼Œæ‰€æœ‰çš„ store éƒ½èƒ½å¤Ÿå•ç‹¬å¼•å…¥ï¼Œè€Œä¸æ˜¯åƒ vuex ä¸€æ ·ï¼Œé€šè¿‡ modules çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰çš„ module æŒ‚è½½åˆ°ä¸€ä¸ª store ä¸Šã€‚</p>
<p>å‡è®¾ï¼Œæˆ‘ä»¬å½“å‰é€šè¿‡ Vuex åˆ›å»ºäº†ä¸€ä¸ª Storeï¼Œè¿™ä¸ª Store ä¸‹æœ‰ä¸¤ä¸ª moduleï¼Œåˆ†åˆ«æ˜¯ç”¨æˆ·æ¨¡å—ï¼ˆUserï¼‰å’Œå•†å“æ¨¡å—ï¼ˆGoodsï¼‰ã€‚å³ä½¿å½“å‰é¦–é¡µåªä½¿ç”¨åˆ°äº†ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯æ•´ä¸ª Store éƒ½ä¼šè¢«æ‰“åŒ…åˆ°é¦–é¡µçš„ js chunk ä¸­ã€‚</p>
<p><img src="https://file.shenfq.com/pic/202112151709033.png" alt=""></p>
<p><img src="https://file.shenfq.com/pic/202112151709945.png" alt=""></p>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ piniaï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ <code>defineStore</code> å®šä¹‰ä¸¤ä¸ª å®Œå…¨æ˜¯åˆ†ç¦»çŠ¶æ€çš„ storeï¼Œä¸¤ä¸ªé¡µé¢åœ¨å¼•å…¥æ—¶ï¼Œä¹Ÿäº’ä¸å½±å“ã€‚æœ€åæ‰“åŒ…çš„æ—¶å€™ï¼Œé¦–é¡µçš„ js chunk å’Œå•†å“é¡µçš„ js chunk ä¼šåˆ†åˆ«æ‰“åŒ…å¯¹åº”çš„ storeã€‚</p>
<p><img src="https://file.shenfq.com/pic/202112151709926.png" alt=""></p>
<hr>
<p>Pinia çš„ä»‹ç»åˆ°è¿™é‡Œå°±å‘Šä¸€æ®µè½äº†ï¼Œå¦‚æœç°åœ¨æœ‰æ–°é¡¹ç›®è¦ä½¿ç”¨ Vue3 è¿›è¡Œå¼€å‘ï¼Œæ¨èæ— è„‘ä½¿ç”¨ Piniaï¼Œæ›´åŠ æ–¹ä¾¿ç®€ä»‹ï¼Œè€Œä¸”å¤§å°ä»… 1KBã€‚</p></article></section><footer>Powered byÂ <a href="https://github.com/xcatliu/pagic" target="_blank">Pagic</a></footer><script src="https://cdn.pagic.org/react@16.13.1/umd/react.production.min.js"></script><script src="https://cdn.pagic.org/react-dom@16.13.1/umd/react-dom.production.min.js"></script><script type="module" src="/index.js"></script></body></html>