---
title: ä½¿ç”¨ESLint+Prettieræ¥ç»Ÿä¸€å‰ç«¯ä»£ç é£æ ¼
author: shenfq
date: 2018/06/18
categories:
- å‰ç«¯
tags:
- å‰ç«¯
- ä»£ç æ ¼å¼åŒ–
- ESLint
---

# ä½¿ç”¨ESLint+Prettieræ¥ç»Ÿä¸€å‰ç«¯ä»£ç é£æ ¼

> åŠ åˆ†å·è¿˜æ˜¯ä¸åŠ åˆ†å·ï¼Ÿtabè¿˜æ˜¯ç©ºæ ¼ï¼Ÿä½ è¿˜åœ¨ä¸ºä»£ç é£æ ¼ä¸åŒäº‹äº‰è®ºå¾—é¢çº¢è€³èµ¤å—ï¼Ÿ


æ­£æ–‡ä¹‹å‰ï¼Œå…ˆçœ‹ä¸ªæ®µå­æ”¾æ¾ä¸€ä¸‹ï¼š [å»æ­»å§ï¼ä½ è¿™ä¸ªå¼‚æ•™å¾’ï¼](https://zhuanlan.zhihu.com/p/19700946)

æƒ³èµ·è‡ªå·±åˆšå…¥è¡Œçš„æ—¶å€™ï¼Œä»svnä¸ŠæŠŠä»£ç checkoutä¸‹æ¥ï¼Œçœ‹åˆ°åŒäº‹å†™çš„ä»£ç ï¼Œå¤§æ‹¬å·å±…ç„¶æ¢è¡Œäº†ã€‚å¿ƒä¸­æš—éª‚ï¼Œè¿™ä¸ªäººæ˜¯ä¸æ˜¯ä¸ª**ï¼Œå¤§æ‹¬å·ä¸ºä»€ä¹ˆè¦æ¢è¡Œï¼Ÿå¹´è½»æ°”ç››çš„æˆ‘ï¼Œå±…ç„¶æ»¡è…”æ€’ç«ï¼Œå°†ç©ºè¡Œä¸€ä¸€åˆ æ‰ã€‚
ä½†æ˜¯å…³äºä»£ç é£æ ¼ï¼Œæˆ‘ä»¬å¾ˆéš¾åŒºåˆ†è°å¯¹è°é”™ï¼Œä¸åŒçš„äººæœ‰ä¸åŒåå¥½ï¼Œå”¯æœ‰å¼ºåˆ¶è¦æ±‚æ‰èƒ½è§„é¿äº‰è®ºã€‚

æ‰€ä»¥ï¼Œå›¢é˜Ÿå…³äºä»£ç é£æ ¼å¿…é¡»éµå¾ªä¸¤ä¸ªåŸºæœ¬åŸåˆ™ï¼š

1. å°‘æ•°æœä»å¤šæ•°ï¼›
2. ç”¨å·¥å…·ç»Ÿä¸€é£æ ¼ã€‚

æœ¬æ–‡å°†ä»‹ç»ï¼Œå¦‚ä½•ä½¿ç”¨ESLint + Prettieræ¥ç»Ÿä¸€æˆ‘ä»¬çš„å‰ç«¯ä»£ç é£æ ¼ã€‚

<!-- more -->


## Prettieræ˜¯ä»€ä¹ˆï¼Ÿ

é¦–å…ˆï¼Œå¯¹åº”ESLintå¤§å¤šéƒ½å¾ˆç†Ÿæ‚‰ï¼Œç”¨æ¥è¿›è¡Œä»£ç çš„æ ¡éªŒï¼Œä½†æ˜¯Prettierï¼ˆç›´è¯‘è¿‡æ¥å°±æ˜¯"æ›´æ¼‚äº®çš„"ğŸ˜‚ï¼‰å¬å¾—å¯èƒ½å°±æ¯”è¾ƒå°‘äº†ã€‚jsä½œä¸ºä¸€é—¨çµæ´»çš„å¼±ç±»å‹è¯­è¨€ï¼Œä»£ç é£æ ¼åƒå¥‡ç™¾æ€ªï¼Œä¸€åƒä¸ªäººå†™jså°±æœ‰ä¸€åƒç§å†™æ³•ã€‚è™½ç„¶jsæ²¡æœ‰å®˜æ–¹æ¨èçš„ä»£ç è§„èŒƒï¼Œä¸è¿‡ç¤¾åŒºæœ‰äº›æ¯”è¾ƒçƒ­é—¨çš„ä»£ç è§„èŒƒï¼Œæ¯”å¦‚[standardjs](https://standardjs.com/readme-zhcn.html)ã€[airbnb](https://github.com/airbnb/javascript)ã€‚ä½¿ç”¨ESLinté…åˆè¿™äº›è§„èŒƒï¼Œèƒ½å¤Ÿæ£€æµ‹å‡ºä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ï¼Œæé«˜ä»£ç è´¨é‡ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å®Œå…¨ç»Ÿä¸€ä»£ç é£æ ¼ï¼Œå› ä¸ºè¿™äº›ä»£ç è§„èŒƒçš„é‡ç‚¹å¹¶ä¸åœ¨ä»£ç é£æ ¼ä¸Šï¼ˆè™½ç„¶æœ‰ä¸€äº›é™åˆ¶ï¼‰ã€‚

#### ä¸‹é¢å¼€å§‹å®‰åˆ©ï¼ŒPrettierã€‚

Prettieræ˜¯ä¸€ä¸ªèƒ½å¤Ÿå®Œå…¨ç»Ÿä¸€ä½ å’ŒåŒäº‹ä»£ç é£æ ¼çš„åˆ©å™¨ï¼Œå‡å¦‚ä½ æœ‰ä¸ªc++ç¨‹åºå‘˜è½¬è¡Œè¿‡æ¥å†™å‰ç«¯çš„åŒäº‹ï¼Œä½ å‘ç°ä½ ä»¬ä»£ç é£æ ¼å®Œå…¨ä¸ä¸€æ ·ï¼Œä½ éš¾é“è¦ä¸€è¡Œè¡Œå»ä¿®æ”¹ä»–çš„ä»£ç å—ï¼Œå°±ç®—ä½ çœŸçš„å»æ”¹ï¼Œä½ çš„éœ€æ±‚æ€ä¹ˆåŠï¼Œæ‰€ä»¥æ²¡æœ‰äººçœŸçš„æ„¿æ„åœ¨ä¿æŒä»£ç é£æ ¼ç»Ÿä¸€ä¸Šé¢æµªè´¹æ—¶é—´ã€‚é€‰æ‹©Prettierèƒ½å¤Ÿè®©ä½ èŠ‚çœå‡ºæ—¶é—´æ¥å†™æ›´å¤šçš„bugï¼ˆä¸å¯¹ï¼Œæ˜¯ä¿®æ›´å¤šçš„bugï¼‰ï¼Œå¹¶ä¸”ç»Ÿä¸€çš„ä»£ç é£æ ¼èƒ½ä¿è¯ä»£ç çš„å¯è¯»æ€§ã€‚

#### çœ‹çœ‹Prettierå¹²çš„å¥½äº‹ã€‚

![gif](https://file.shenfq.com/18-6-18/90739745.jpg)
![gif](https://file.shenfq.com/18-6-18/93998995.jpg)

èƒ½æ”¯æŒjsx

![gif](https://file.shenfq.com/18-6-18/85648012.jpg)

ä¹Ÿèƒ½æ”¯æŒcss

![gif](https://file.shenfq.com/18-6-18/55246702.jpg)

å”¯ä¸€çš„é—æ†¾æ˜¯ï¼Œæš‚æ—¶è¿˜ä¸èƒ½æ ¼å¼åŒ–vueæ¨¡ç‰ˆæ–‡ä»¶ä¸­templateéƒ¨åˆ†ã€‚


## ESLint ä¸ Prettieré…åˆä½¿ç”¨

é¦–å…ˆè‚¯å®šæ˜¯éœ€è¦å®‰è£…`prettier`ï¼Œå¹¶ä¸”ä½ çš„é¡¹ç›®ä¸­å·²ç»ä½¿ç”¨äº†ESLintï¼Œæœ‰`eslintrc.js`é…ç½®æ–‡ä»¶ã€‚

```bash
npm i -D prettier
```

#### é…åˆESLintæ£€æµ‹ä»£ç é£æ ¼

å®‰è£…æ’ä»¶ï¼š

```bash
npm i -D eslint-plugin-prettier
```

eslint-plugin-prettieræ’ä»¶ä¼šè°ƒç”¨prettierå¯¹ä½ çš„ä»£ç é£æ ¼è¿›è¡Œæ£€æŸ¥ï¼Œå…¶åŸç†æ˜¯å…ˆä½¿ç”¨prettierå¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¸æ ¼å¼åŒ–ä¹‹å‰çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¿‡å‡ºç°äº†ä¸ä¸€è‡´ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šè¢«prettierè¿›è¡Œæ ‡è®°ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨rulesä¸­æ·»åŠ ï¼Œ`"prettier/prettier": "error"`ï¼Œè¡¨ç¤ºè¢«prettieræ ‡è®°çš„åœ°æ–¹æŠ›å‡ºé”™è¯¯ä¿¡æ¯ã€‚

```js
//.eslintrc.js
{
  "plugins": ["prettier"],
  "rules": {
    "prettier/prettier": "error"
  }
}
```

å€ŸåŠ©ESLintçš„autofixåŠŸèƒ½ï¼Œåœ¨ä¿å­˜ä»£ç çš„æ—¶å€™ï¼Œè‡ªåŠ¨å°†æŠ›å‡ºerrorçš„åœ°æ–¹è¿›è¡Œfixã€‚å› ä¸ºæˆ‘ä»¬é¡¹ç›®æ˜¯åœ¨webpackä¸­å¼•å…¥eslint-loaderæ¥å¯åŠ¨eslintçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ç¨å¾®ä¿®æ”¹webpackçš„é…ç½®ï¼Œå°±èƒ½åœ¨å¯åŠ¨webpack-dev-serverçš„æ—¶å€™ï¼Œæ¯æ¬¡ä¿å­˜ä»£ç åŒæ—¶è‡ªåŠ¨å¯¹ä»£ç è¿›è¡Œæ ¼å¼åŒ–ã€‚

```javascript
const path = require('path')
module.exports = {
  module: {
    rules: [
      {
        test: /\.(js|vue)$/,
    	loader: 'eslint-loader',
    	enforce: 'pre',
    	include: [path.join(__dirname, 'src')],
    	options: {
          fix: true
    	}
      }
    ]
}
```

å¦‚æœä½ çš„eslintæ˜¯ç›´æ¥é€šè¿‡cliæ–¹å¼å¯åŠ¨çš„ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨åé¢åŠ ä¸Šfixå³å¯ï¼Œå¦‚ï¼š`eslint --fix`ã€‚


#### å¦‚æœä¸å·²å­˜åœ¨çš„æ’ä»¶å†²çªæ€ä¹ˆåŠ

```bash
npm i -D eslint-config-prettier
```

é€šè¿‡ä½¿ç”¨eslint-config-prettieré…ç½®ï¼Œèƒ½å¤Ÿå…³é—­ä¸€äº›ä¸å¿…è¦çš„æˆ–è€…æ˜¯ä¸prettierå†²çªçš„linté€‰é¡¹ã€‚è¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šçœ‹åˆ°ä¸€äº›erroråŒæ—¶å‡ºç°ä¸¤æ¬¡ã€‚ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç¡®ä¿ï¼Œè¿™ä¸ªé…ç½®åœ¨extendsçš„æœ€åä¸€é¡¹ã€‚

```javascript
//.eslintrc.js
{
  extends: [
    'standard', //ä½¿ç”¨standardåšä»£ç è§„èŒƒ
    "prettier",
  ],
}
```

è¿™é‡Œæœ‰ä¸ª[æ–‡æ¡£](https://github.com/prettier/eslint-config-prettier#special-rules)ï¼Œåˆ—å‡ºäº†ä¼šä¸prettierå†²çªçš„é…ç½®é¡¹ã€‚


#### åŒæ—¶ä½¿ç”¨ä¸Šé¢ä¸¤é¡¹é…ç½®

å¦‚æœä½ åŒæ—¶ä½¿ç”¨äº†ä¸Šè¿°çš„ä¸¤ç§é…ç½®ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼Œç®€åŒ–ä½ çš„é…ç½®ã€‚

```javascript
//.eslintrc.js
{
  "extends": ["plugin:prettier/recommended"]
}
```

æœ€åè´´ä¸€ä¸‹æˆ‘ä»¬é¡¹ç›®ä¸­çš„å®Œæ•´é…ç½®ï¼Œæ˜¯åœ¨vue-cliç”Ÿæˆçš„ä»£ç åŸºç¡€ä¸Šä¿®æ”¹çš„ï¼Œå¹¶ä¸”ä½¿ç”¨standardåšä»£ç è§„èŒƒï¼š

```javascript
module.exports = {
  root: true,
  parserOptions: {
    parser: 'babel-eslint'
  },
  env: {
    browser: true,
    es6: true
  },
  extends: [
    // https://github.com/standard/standard/blob/master/docs/RULES-en.md
    'standard',
    // https://github.com/vuejs/eslint-plugin-vue#priority-a-essential-error-prevention
    // consider switching to `plugin:vue/strongly-recommended` or `plugin:vue/recommended` for stricter rules.
    'plugin:vue/essential',
    "plugin:prettier/recommended",
  ],
  // required to lint *.vue files
  plugins: [
    'vue'
  ],
  // add your custom rules here
  rules: {
    "prettier/prettier": "error",
    // allow async-await
    'generator-star-spacing': 'off',
    // allow debugger during development
    'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off'
  }
}

```

#### ä»€ä¹ˆï¼Ÿä½ ä»¬é¡¹ç›®æ²¡æœ‰å¯ç”¨ESLint

ä¸è¦æ…Œï¼Œæ²¡æœ‰ESLintä¹Ÿä¸è¦æ€•ï¼Œå¯ä»¥é€šè¿‡[onchange](https://www.npmjs.com/package/onchange)è¿›è¡Œä»£ç çš„ç›‘å¬ï¼Œç„¶åè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ã€‚åªè¦åœ¨package.jsonçš„scriptsä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œç„¶åä½¿ç”¨`npm run format`ï¼Œæˆ‘ä»¬å°±èƒ½ç›‘å¬srcç›®å½•ä¸‹æ‰€æœ‰çš„jsæ–‡ä»¶å¹¶è¿›è¡Œæ ¼å¼åŒ–ï¼š

```javascript
"scripts": {
  "format": "onchange 'src/**/*.js' -- prettier --write {{changed}}"
}
```

å½“ä½ æƒ³æ ¼å¼åŒ–çš„æ–‡ä»¶ä¸æ­¢jsæ–‡ä»¶æ—¶ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å¤šä¸ªæ–‡ä»¶åˆ—è¡¨ã€‚

```javascript
"scripts": {
  "format": "onchange 'test/**/*.js' 'src/**/*.js' 'src/**/*.vue' -- prettier --write {{changed}}"
}
```

å½“ç„¶ï¼Œä½ ä¹Ÿèƒ½å¤Ÿåœ¨ç¼–è¾‘å™¨ä¸­é…ç½®å¯¹prettierçš„æ”¯æŒï¼Œå…·ä½“æ”¯æŒå“ªäº›ç¼–è¾‘å™¨ï¼Œè¯·æˆ³[è¿™é‡Œ](https://prettier.io/docs/en/editors.html)


## å¦‚ä½•å¯¹Prettierè¿›è¡Œé…ç½®

ä¸€å…±æœ‰ä¸‰ç§æ–¹å¼æ”¯æŒå¯¹Prettierè¿›è¡Œé…ç½®ï¼š

1. æ ¹ç›®å½•åˆ›å»º`.prettierrc `æ–‡ä»¶ï¼Œèƒ½å¤Ÿå†™å…¥YMLã€JSONçš„é…ç½®æ ¼å¼ï¼Œå¹¶ä¸”æ”¯æŒ`.yaml/.yml/.json/.js`åç¼€ï¼›
2. æ ¹ç›®å½•åˆ›å»º`.prettier.config.js `æ–‡ä»¶ï¼Œå¹¶å¯¹å¤–exportä¸€ä¸ªå¯¹è±¡ï¼›
3. åœ¨`package.json`ä¸­æ–°å»º`prettier`å±æ€§ã€‚

ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨`prettierrc.js`çš„æ–¹å¼å¯¹prettierè¿›è¡Œé…ç½®ï¼ŒåŒæ—¶è®²è§£ä¸‹å„ä¸ªé…ç½®çš„ä½œç”¨ã€‚

```javascript
module.exports = {
  "printWidth": 80, //ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œï¼Œé»˜è®¤ä¸º80
  "tabWidth": 2, //ä¸€ä¸ªtabä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°ï¼Œé»˜è®¤ä¸º80
  "useTabs": false, //æ˜¯å¦ä½¿ç”¨tabè¿›è¡Œç¼©è¿›ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºç”¨ç©ºæ ¼è¿›è¡Œç¼©å‡
  "singleQuote": false, //å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·ï¼Œé»˜è®¤ä¸ºfalseï¼Œä½¿ç”¨åŒå¼•å·
  "semi": true, //è¡Œä½æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue
  "trailingComma": "none", //æ˜¯å¦ä½¿ç”¨å°¾é€—å·ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼"<none|es5|all>"
  "bracketSpacing": true, //å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸ºtrueï¼Œæ•ˆæœï¼š{ foo: bar }
  "parser": "babylon" //ä»£ç çš„è§£æå¼•æ“ï¼Œé»˜è®¤ä¸ºbabylonï¼Œä¸babelç›¸åŒã€‚
}
```

é…ç½®å¤§æ¦‚åˆ—å‡ºäº†è¿™äº›ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–é…ç½®å¯ä»¥åœ¨[å®˜æ–¹æ–‡æ¡£](https://prettier.io/docs/en/options.html)è¿›è¡ŒæŸ¥é˜…ã€‚

æ³¨æ„ä¸€ç‚¹ï¼Œparserçš„é…ç½®é¡¹å®˜ç½‘åˆ—å‡ºäº†å¦‚ä¸‹å¯é€‰é¡¹ï¼š

- babylon
- flow
- typescript Since v1.4.0
- postcss Since v1.4.0
- json Since v1.5.0
- graphql Since v1.5.0
- markdown Since v1.8.0

ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨äº†vueçš„å•æ–‡ä»¶ç»„ä»¶å½¢å¼ï¼Œè®°å¾—å°†`parser`é…ç½®ä¸ºvueï¼Œç›®å‰å®˜æ–¹æ–‡æ¡£æ²¡æœ‰åˆ—å‡ºæ¥ã€‚å½“ç„¶å¦‚æœä½ è‡ªå·±å†™è¿‡ASTçš„è§£æå™¨ï¼Œä¹Ÿå¯ä»¥ç”¨ä½ è‡ªå·±çš„å†™çš„`parser: require("./my-parser")`ã€‚



## æ€»ç»“

æœ‰äº†prettieræˆ‘ä»¬å†ä¹Ÿä¸ç”¨ç¾¡æ…•éš”å£å†™golangçš„åŒäº‹ï¼Œä¿å­˜åå°±èƒ½è‡ªåŠ¨formatï¼Œä¹Ÿä¸ç”¨ä¸ºäº†é¡¹ç›®ä»£ç ä¸ç»Ÿä¸€å’ŒåŒäº‹äº‰è®ºå¾—é¢çº¢è€³èµ¤ï¼Œå› ä¸ºæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨prettierçš„é£æ ¼ã€‚å¯èƒ½åˆšå¼€å§‹æœ‰äº›åœ°æ–¹ä½ çœ‹ä¸æƒ¯ï¼Œä¸è¿‡ä¸è¦ç´§ï¼Œæƒ³æƒ³è¿™ä¹ˆåšéƒ½æ˜¯ä¸ºäº†å›¢é˜Ÿå’Œç¦ï¼Œä¸–ç•Œå’Œå¹³ï¼Œæˆ‘ä»¬åšå‡ºçš„ç‰ºç‰²éƒ½æ˜¯å¿…è¦çš„ã€‚è€Œä¸”prettierçš„æ ·å¼é£æ ¼å·²ç»åœ¨å¾ˆå¤šå¤§å‹å¼€æºé¡¹ç›®ä¸­è¢«é‡‡ç”¨ï¼Œæ¯”å¦‚reactã€webpackã€babelã€‚

![ä»–ä»¬éƒ½åœ¨ç”¨](https://file.shenfq.com/18-6-18/78377904.jpg)

ä½ çœ‹ï¼Œä»–ä»¬éƒ½åœ¨ç”¨äº†ï¼Œä½ è¿˜åœ¨ç­‰ä»€ä¹ˆï¼Œæƒ³å˜æˆå¼‚æ•™å¾’è¢«çƒ§æ­»å—ï¼Œè¿˜ä¸å¿«è¡ŒåŠ¨èµ·æ¥ã€‚æ›´å¤šç²¾å½©å†…å®¹è¯·çœ‹[å®˜æ–¹é“¾æ¥](https://prettier.io/)


