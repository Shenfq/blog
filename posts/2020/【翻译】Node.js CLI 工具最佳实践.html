<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【翻译】Node.js CLI 工具最佳实践 | 自然醒的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?681a9f14f2db8e622747ef03c33bb367";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.b6006e22.css" as="style"><link rel="preload" href="/assets/js/app.dd3d10c5.js" as="script"><link rel="preload" href="/assets/js/3.507ff108.js" as="script"><link rel="preload" href="/assets/js/1.a547ec77.js" as="script"><link rel="preload" href="/assets/js/56.9fc2cca2.js" as="script"><link rel="prefetch" href="/assets/js/10.6013c20b.js"><link rel="prefetch" href="/assets/js/11.3d8fc37f.js"><link rel="prefetch" href="/assets/js/12.d356848f.js"><link rel="prefetch" href="/assets/js/13.503aa3ef.js"><link rel="prefetch" href="/assets/js/14.0cc170d7.js"><link rel="prefetch" href="/assets/js/15.80a29d65.js"><link rel="prefetch" href="/assets/js/16.eeef94d5.js"><link rel="prefetch" href="/assets/js/17.473fd739.js"><link rel="prefetch" href="/assets/js/18.7a94ffa7.js"><link rel="prefetch" href="/assets/js/19.1049cfdf.js"><link rel="prefetch" href="/assets/js/20.928b8fee.js"><link rel="prefetch" href="/assets/js/21.8fa143ce.js"><link rel="prefetch" href="/assets/js/22.b094a8de.js"><link rel="prefetch" href="/assets/js/23.9897185b.js"><link rel="prefetch" href="/assets/js/24.12f7413e.js"><link rel="prefetch" href="/assets/js/25.251a0dbc.js"><link rel="prefetch" href="/assets/js/26.bf0e0cf4.js"><link rel="prefetch" href="/assets/js/27.d4dc9aa5.js"><link rel="prefetch" href="/assets/js/28.b67394ce.js"><link rel="prefetch" href="/assets/js/29.2c093fe1.js"><link rel="prefetch" href="/assets/js/30.88baa945.js"><link rel="prefetch" href="/assets/js/31.db871da7.js"><link rel="prefetch" href="/assets/js/32.aca26529.js"><link rel="prefetch" href="/assets/js/33.4355b0d1.js"><link rel="prefetch" href="/assets/js/34.1e25eec3.js"><link rel="prefetch" href="/assets/js/35.33b6be8f.js"><link rel="prefetch" href="/assets/js/36.af8dc1b5.js"><link rel="prefetch" href="/assets/js/37.0a442b7d.js"><link rel="prefetch" href="/assets/js/38.b8932c36.js"><link rel="prefetch" href="/assets/js/39.873ac12b.js"><link rel="prefetch" href="/assets/js/4.22f3476d.js"><link rel="prefetch" href="/assets/js/40.902ba1b5.js"><link rel="prefetch" href="/assets/js/41.b3a01dd9.js"><link rel="prefetch" href="/assets/js/42.e124f445.js"><link rel="prefetch" href="/assets/js/43.a3cd5e06.js"><link rel="prefetch" href="/assets/js/44.77a9226e.js"><link rel="prefetch" href="/assets/js/45.0c563d44.js"><link rel="prefetch" href="/assets/js/46.abecd608.js"><link rel="prefetch" href="/assets/js/47.945d2559.js"><link rel="prefetch" href="/assets/js/48.96121d35.js"><link rel="prefetch" href="/assets/js/49.b6e988b3.js"><link rel="prefetch" href="/assets/js/5.eb73409d.js"><link rel="prefetch" href="/assets/js/50.51197aa2.js"><link rel="prefetch" href="/assets/js/51.cba93298.js"><link rel="prefetch" href="/assets/js/52.5845bf72.js"><link rel="prefetch" href="/assets/js/53.05e334fd.js"><link rel="prefetch" href="/assets/js/54.730245bb.js"><link rel="prefetch" href="/assets/js/55.fe4f1899.js"><link rel="prefetch" href="/assets/js/57.ba509f83.js"><link rel="prefetch" href="/assets/js/58.e2c3009c.js"><link rel="prefetch" href="/assets/js/59.45cf1f42.js"><link rel="prefetch" href="/assets/js/6.c75b1c30.js"><link rel="prefetch" href="/assets/js/60.cb622813.js"><link rel="prefetch" href="/assets/js/61.77d4b62e.js"><link rel="prefetch" href="/assets/js/62.7acffff4.js"><link rel="prefetch" href="/assets/js/63.a9a1e121.js"><link rel="prefetch" href="/assets/js/64.2952287b.js"><link rel="prefetch" href="/assets/js/65.e46eb76e.js"><link rel="prefetch" href="/assets/js/66.d6579358.js"><link rel="prefetch" href="/assets/js/67.263c1a64.js"><link rel="prefetch" href="/assets/js/68.167b338f.js"><link rel="prefetch" href="/assets/js/69.7cc7de17.js"><link rel="prefetch" href="/assets/js/7.7e6be3ad.js"><link rel="prefetch" href="/assets/js/70.4cd87fd5.js"><link rel="prefetch" href="/assets/js/71.03d8452b.js"><link rel="prefetch" href="/assets/js/72.ed53a810.js"><link rel="prefetch" href="/assets/js/73.9a316584.js"><link rel="prefetch" href="/assets/js/74.fabacaa2.js"><link rel="prefetch" href="/assets/js/75.8d7e3516.js"><link rel="prefetch" href="/assets/js/76.ffbb5827.js"><link rel="prefetch" href="/assets/js/77.a54abacd.js"><link rel="prefetch" href="/assets/js/78.387b274e.js"><link rel="prefetch" href="/assets/js/79.4245741e.js"><link rel="prefetch" href="/assets/js/8.089b1e80.js"><link rel="prefetch" href="/assets/js/80.e7c18fed.js"><link rel="prefetch" href="/assets/js/81.c6465575.js"><link rel="prefetch" href="/assets/js/82.4e0588dd.js"><link rel="prefetch" href="/assets/js/83.846e3dd3.js"><link rel="prefetch" href="/assets/js/84.42030c5b.js"><link rel="prefetch" href="/assets/js/85.eb6c0afb.js"><link rel="prefetch" href="/assets/js/86.b1e4b9b2.js"><link rel="prefetch" href="/assets/js/87.f48ae41b.js"><link rel="prefetch" href="/assets/js/88.84bcc4c7.js"><link rel="prefetch" href="/assets/js/89.c36e2e4e.js"><link rel="prefetch" href="/assets/js/9.a15a624d.js"><link rel="prefetch" href="/assets/js/90.1b535ac6.js"><link rel="prefetch" href="/assets/js/91.643af168.js"><link rel="prefetch" href="/assets/js/92.56bcb90f.js"><link rel="prefetch" href="/assets/js/93.2c179837.js"><link rel="prefetch" href="/assets/js/94.5e1d5354.js"><link rel="prefetch" href="/assets/js/95.1591a73b.js"><link rel="prefetch" href="/assets/js/96.07185bc3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b6006e22.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>自然醒的博客</h3> <p class="description" data-v-59e6cb88> </p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2022
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">自然醒的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  自我介绍
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>85</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>127</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  自我介绍
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>【翻译】Node.js CLI 工具最佳实践</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2022
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">【翻译】Node.js CLI 工具最佳实践</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>shenfq</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2/22/2020</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>前端</span><span class="tag-item" data-v-8a445198>翻译</span><span class="tag-item" data-v-8a445198>Node</span></i></div></div> <div class="theme-reco-content content__default"><blockquote><p><a href="https://github.com/lirantal/nodejs-cli-apps-best-practices/blob/3afe1ab0a5b506ef8c32903c4bf253a4cdb4bddd/README.md#shell-interpreters-vary" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>这是一个关于如何构建成功的、可移植的、对用户友好的Node.js 命令行工具（CLI）最佳实践的集合。</p> <h2 id="为什么写这篇文章"><a href="#为什么写这篇文章" class="header-anchor">#</a> 为什么写这篇文章？</h2> <p>一个糟糕的 CLI 工具会让用户觉得难用，而构建一个成功的 CLI 需要密切关注很多细节，同时需要站在用户的角度，创造良好的用户体验。要做到这些特别不容易。</p> <p>在这个指南中，我列出了在各个重点领域的最佳实践，都是 CLI 工具交互最理想的用户体验。</p> <h2 id="特性"><a href="#特性" class="header-anchor">#</a> 特性：</h2> <ul><li>✅ 构建成功的 Node.js CLI 工具的 21 种最佳实践</li> <li>❤️ 帮忙翻译成其他语言</li> <li>🙏 欢迎捐赠</li> <li>最近更新时间：2020-02-14</li></ul> <h2 id="为什么是我"><a href="#为什么是我" class="header-anchor">#</a> 为什么是我？</h2> <p>我叫Liran Tal，我一直专注于构建命令行工具。</p> <p>我最近的一些工作就是构建Node.js CLI，包括以下开源项目：</p> <table><thead><tr><th><a href="https://github.com/lirantal/dockly" target="_blank" rel="noopener noreferrer"><strong>Dockly</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></th> <th><a href="https://github.com/lirantal/npq" target="_blank" rel="noopener noreferrer"><strong>npq</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></th> <th><a href="https://github.com/lirantal/lockfile-lint" target="_blank" rel="noopener noreferrer"><strong>lockfile-lint</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></th> <th><a href="https://github.com/lirantal/is-website-vulnerable" target="_blank" rel="noopener noreferrer"><strong>is-website-vulnerable</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></th></tr></thead> <tbody><tr><td>沉浸式终端界面，用于管理Docker容器和服务</td> <td>通过在安装过程中进行检查，以安全地使用npm / yarn 安装的软件包</td> <td>整理 npm 或 yarn 的 lock 文件以分析和检测安全问题</td> <td>在网站引用的 JS 库中查找公开的安全漏洞</td></tr></tbody></table> <hr> <h2 id="_1-命令行的经验"><a href="#_1-命令行的经验" class="header-anchor">#</a> 1 命令行的经验</h2> <p>本节将会介绍创建美观且高可用的 Node.js 命令行工具相关的最佳实践。</p> <h3 id="_1-1-尊重-posix"><a href="#_1-1-尊重-posix" class="header-anchor">#</a> 1.1 尊重 POSIX</h3> <p>✅ <strong>正确：</strong> 使用兼容 <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html" target="_blank" rel="noopener noreferrer">POSIX-compliant<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令行的语法，因为这是被广泛接受的命令行工具的标准。</p> <p>❌ <strong>错误：</strong> 当用户使用CLI，其命令行参数与他们过去的使用习惯不一致时，会感觉很难适应。</p> <p>➡️ <strong>细节：</strong></p> <p>Unix-like 操作系统普及了命令行工具，比如awk，sed。这样的工具已经有效地标准化了命令行选项「options」（又名标志「flags」），选项参数和其他操作的行为。</p> <p>一些案例：</p> <ul><li>在帮助「help」中将选项参数「option-arguments」标记为方括号([])，以表示它们是可选的，或者使用尖括号(&lt;&gt;)，表示它们是必需的。</li> <li>参数可以使用单字符缩写，一般是 <code>-</code> 加上一个字母或数字。</li> <li>多个没有值的选型可进行组合，比如：<code>cli -abc</code> 等价于 <code>cli -a -b -c</code>。</li></ul> <p>用户一般都会希望你的命令行工具与其他Unix工具具有类似的约定。</p> <h3 id="_1-2-构建友好的-cli"><a href="#_1-2-构建友好的-cli" class="header-anchor">#</a> 1.2 构建友好的 CLI</h3> <p>✅ <strong>正确：</strong> 尽可能多的输出一些信息以帮助用户成功使用 CLI。</p> <p>❌ <strong>错误：</strong> 由于 CLI 一直启动失败，又没有为用户提供足够的帮助，会让用户产生明显的挫败感。</p> <p>➡️ <strong>细节：</strong></p> <p>命令行工具的界面一定程度上应与 Web 用户界面类似，尽可能的保证程序能正常使用。</p> <p>构建一个对用户友好的 CLI 应该尽可能的为用户提供支持。作为实例，我们讨论下 <code>curl</code> 命令的交互，该命令期望将 URL 作为主要的数据输入，而用户却没有提供 URL，这时候命令行会提示用户通读 <code>curl --help</code> 的输出信息。但是，对用户友好的 CLI 工具会显示一个可交互式的提示，捕获用户的输入，从而正常运行。</p> <h3 id="_1-3-有状态的数据"><a href="#_1-3-有状态的数据" class="header-anchor">#</a> 1.3 有状态的数据</h3> <p>✅ <strong>正确：</strong> 在多次调用 CLI 的过程中，提供有状态的体验，记住这些数据，以提供无缝的交互体验。</p> <p>❌ <strong>错误：</strong> 用户多次调用 CLI 重复提供相同的信息，会让用户感到厌烦。</p> <p>➡️ <strong>细节：</strong></p> <p>你需要为 CLI 工具提供持续缓存，比如记住用户名、电子邮件、token 或者是 CLI 多次调用的一些首选项。可以使用以下工具来保留用户的这些配置。</p> <ul><li><p><a href="https://www.npmjs.com/package/configstore" target="_blank" rel="noopener noreferrer">configstore<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://www.npmjs.com/package/conf" target="_blank" rel="noopener noreferrer">conf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h3 id="_1-4-提供多彩的体验"><a href="#_1-4-提供多彩的体验" class="header-anchor">#</a> 1.4 提供多彩的体验</h3> <p>✅ <strong>正确：</strong> 在 CLI 工具中使用颜色来突出显示一些信息，并且提供降级方案，进行检测，自动退出以免输出乱码。</p> <p>❌ <strong>错误：</strong> 苍白的输出可能会让用户丢失重要的信息，尤其是文本较多的时候。</p> <p>➡️ <strong>细节：</strong></p> <p>大多数的命令行工具都支持彩色文本，通过特定的 ANSI 编码来启用。
命令行工具输出彩色文本可带来更丰富的体验和更多的交互。但是，不受支持的终端可能会在屏幕上以乱码信息的形式输出。此外，CLI 也可能用于不支持彩色输出的连续集成中。</p> <ul><li><a href="https://www.npmjs.com/package/chalk" target="_blank" rel="noopener noreferrer">chalk<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/colors" target="_blank" rel="noopener noreferrer">colors<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="_1-5-丰富的交互"><a href="#_1-5-丰富的交互" class="header-anchor">#</a> 1.5 丰富的交互</h3> <p>✅ <strong>正确：</strong>  提供除了文本输入之外的其他交互形式，为用户提供更加丰富的体验。</p> <p>❌ <strong>错误：</strong> 当输入的信息是固定的选项（类似下拉菜单）时，文本输入的形式可能会给用户带来麻烦。</p> <p>➡️ <strong>细节：</strong></p> <p>可以以提示输入的方式引入更加丰富的交互方式，提示输入比自由的文本输入更高端。例如，下拉列表、单选按钮切换、隐藏密码输入。丰富交互的另一个方面就是动画以及进度条，在 CLI 执行异步工作时，都能为用户提供更好的体验。</p> <p>许多 CLI 提供默认的命令行参数，而无需用户进一步交互。不强迫用户提供一些非必要的参数。</p> <ul><li><a href="https://www.npmjs.com/package/prompts" target="_blank" rel="noopener noreferrer">prompts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/enquirer" target="_blank" rel="noopener noreferrer">enquirer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/ink" target="_blank" rel="noopener noreferrer">ink<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/chalk" target="_blank" rel="noopener noreferrer">ora<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="_1-6-无处不在的超链接"><a href="#_1-6-无处不在的超链接" class="header-anchor">#</a> 1.6 无处不在的超链接</h3> <p>✅ <strong>正确：</strong>  URL（https://www.github.com）和源代码（<code>src/Util.js:2:75</code>）使用格式正确的文本输出，因为这两者都是现代终端可点击的链接。</p> <p>❌ <strong>错误：</strong> 避免使用<code>git.io/abc</code>之类的非交互式的链接，该链接需要用户手动复制和粘贴。</p> <p>➡️ <strong>细节：</strong></p> <p>如果你要分享的信息在 Url 链接中，或者是某个文件的特定行列，则需要向用户提供正确的格式的链接，用户一旦点击它们，就会打开浏览器或者在IDE跳到特定位置。</p> <h3 id="_1-7-零配置"><a href="#_1-7-零配置" class="header-anchor">#</a> 1.7 零配置</h3> <p>✅ <strong>正确：</strong> 通过自动检测所需的配置和命令行参数，达到即开即用的体验。</p> <p>❌ <strong>错误：</strong> 如果可以以可靠的方式自动检测命令行参数，并且调用的操作不需用户显式确认（例如确认删除），则不要强制用户交互。</p> <p>➡️ <strong>细节：</strong></p> <p>旨在在运行 CLI 工具时提供“即开即用”的体验。</p> <ul><li>The <a href="https://jestjs.io/" target="_blank" rel="noopener noreferrer">Jest JavaScript Testing Framework<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://parceljs.org/" target="_blank" rel="noopener noreferrer">Parcel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, a web application bundler</li></ul> <h2 id="_2-发布"><a href="#_2-发布" class="header-anchor">#</a> 2 发布</h2> <p>本节介绍了如何以最佳方式分发和打包 Node.js CLI 工具的最佳实践。</p> <h3 id="_2-1-最小化的依赖"><a href="#_2-1-最小化的依赖" class="header-anchor">#</a> 2.1 最小化的依赖</h3> <p>✅ <strong>正确：</strong> 最大程度地减少生产环境的依赖项，并且使用可替代的最小的依赖包，确保这是一个尽可能小的 Node.js 包。但是，也不能过于谨慎因此重复发明轮子而过度优化依赖。</p> <p>❌ <strong>错误：</strong> 应用中依赖的大小将决定 CLI 的安装时间，从而导致糟糕的用户体验。</p> <p>➡️ <strong>细节：</strong></p> <p>使用 <code>npx</code> 可以快速调用通过 <code>npm install</code> 安装的 Node.js CLI 模块，这可提供更好的用户体验。这有助于将整体的依赖关系和传递依赖关系保持在合理大小。</p> <p>npm 全局安装模块，安装过程会变得缓慢，这是一个糟糕的体验。通过 npx 总是获取当前项目安装的模块（当前文件夹的node_modules），因此使用 <code>npx</code> 来调用 CLI 可能会降低性能。</p> <h3 id="_2-2-使用文件锁"><a href="#_2-2-使用文件锁" class="header-anchor">#</a> 2.2 使用文件锁</h3> <p>✅ <strong>正确：</strong> 通过 npm 提供的 package-lock.json 来锁定安装包，以确保用户安装的时候使用的依赖版本是准确的。</p> <p>❌ <strong>错误：</strong> 不锁定依赖的版本，意味着 npm 将在安装过程中自己解决他们，从而导致安装依赖的版本范围扩大，这会引入无法控制的更改，可能会让 CLI 无法成功运行。</p> <p>➡️ <strong>细节：</strong></p> <p>通常，npm 包在发布时只定义其直接的依赖项及其版本范围，并且 npm 会在安装时解析所有间接依赖项的版本。随着时间的流逝，间接的依赖项版本会有所不同，因为依赖项随时会发布新版本。
尽管维护人员已广泛使用<a href="https://semver.org/" target="_blank" rel="noopener noreferrer">版本控制语义<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，但是 npm 会为安装的包引入许多间接的依赖关系，这些间接依赖提升了破坏您的应用程序的风险。
使用 package-lock.json 会带给用户更好的安全感。将要安装的依赖项固定到特定版本，因此，即使这些依赖项发布了较新的版本，也不会安装它们。这将让您有责任保持对依赖项的关注，了解依赖项中任何安全相关的修复，并通过定期发布 CLI 工具进行安全更新。可以考虑使用<a href="https://snyk.io/" target="_blank" rel="noopener noreferrer">Snyk<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来自动修复整个依赖性树中的安全性问题。<em>注：我是Snyk的开发者开发者。</em>
参考：</p> <ul><li><a href="https://snyk.io/blog/making-sense-of-package-lock-files-in-the-npm-ecosystem/" target="_blank" rel="noopener noreferrer">Do you really know how a lockfile works for yarn and npm packages?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://next.yarnpkg.com/advanced/qa/#should-lockfiles-be-committed-to-the-repository" target="_blank" rel="noopener noreferrer">Yarn docs: Should lockfiles be committed to the repository?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_3-通用性"><a href="#_3-通用性" class="header-anchor">#</a> 3 通用性</h2> <p>本节将介绍使 Node.js CLI 与其他命令行工具无缝集成有关的最佳实践，并遵循 CLI 正常运行的约定。</p> <p>本节将回答以下问题：</p> <ul><li>我可以导出 CLI 的输出以便于分析吗？</li> <li>我可以将 CLI 的输出通过管道传递到另一个命令行工具的输入吗？</li> <li>是否可以将其他工具的结果通过管道传输到此 CLI？</li></ul> <h3 id="_3-1-接受-stdin-作为输入"><a href="#_3-1-接受-stdin-作为输入" class="header-anchor">#</a> 3.1 接受 STDIN 作为输入</h3> <p>✅ <strong>正确：</strong> 对于数据驱动的命令行应用，用户可以轻松的通过管道将数据输入到 STDIN。</p> <p>❌ <strong>错误：</strong> 其他的命令行工具可能无法直接提供数据输入到你的 CLI 中，这会阻止某些代码的正常运行，例如：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token string">&quot;https://api.example.com/data.json&quot;</span> <span class="token operator">|</span> your_cli
</code></pre></div><p>➡️ <strong>细节：</strong></p> <p>如果命令行工具需要处理某些数据，比如，指定 JSON 文件执行某种任务，一般使用 <code>--file file.json</code> 的命令行参数。</p> <h3 id="_3-2-结构化输出"><a href="#_3-2-结构化输出" class="header-anchor">#</a> 3.2 结构化输出</h3> <p>✅ <strong>正确：</strong> 通过某个参数来允许应用的结果进行结构化的输出，这样使得数据更容易处理和解析。</p> <p>❌ <strong>错误：</strong> 用户可能需要使用复杂的正则来解析和匹配 CLI 的输出结果。</p> <p>➡️ <strong>细节：</strong></p> <p>对于 CLI 的用户来说，解析数据并使用数据来执行其他任务（比如，提供给 web 仪表盘或电子邮件）通常很有用。
能够轻松地从命令行输出中得到需要的数据，这将为 CLI 的用户提供更好的体验。</p> <h3 id="_3-3-跨平台"><a href="#_3-3-跨平台" class="header-anchor">#</a> 3.3 跨平台</h3> <p>✅ <strong>正确：</strong> 如果希望 CLI 能够跨平台工作，则必须注意命令行 shell 和子系统（如文件系统）的语义。</p> <p>❌ <strong>错误：</strong> 由于错误的路径分隔符等因素，CLI 将在一些操作系统上无法运行，即使代码中没有明显的功能差异。</p> <p>➡️ <strong>细节：</strong></p> <p>单纯从代码的角度来看，功能没有被剥离，并且应该在不同的操作系统中执行良好，但是一些遗漏的细节可能会使程序无法运行。让我们来研究几个必须遵守跨平台规范的案例。</p> <h4 id="产生错误的命令"><a href="#产生错误的命令" class="header-anchor">#</a> 产生错误的命令</h4> <p>有时候我们需要运行 Node.js 程序的进程，假设您有如下的脚本：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// program.js</span>
#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env bin

<span class="token comment">// your app code</span>
</code></pre></div><p>然后使用如下方式启动。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cliExecPath <span class="token operator">=</span> <span class="token string">'program.js'</span>
<span class="token keyword">const</span> process <span class="token operator">=</span> childProcess<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span>cliExecPath<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>上面的代码能工作，但是下面这样更好。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cliExecPath <span class="token operator">=</span> <span class="token string">'program.js'</span>
<span class="token keyword">const</span> process <span class="token operator">=</span> childProcess<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>cliExecPath<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>为什么这样更好呢？因为 <code>program.js</code> 代码以类 Unix 的  <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" target="_blank" rel="noopener noreferrer">Shebang<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 符号开始，但是由于这不是跨平台的标准，Windows 不知道如何解析。</p> <p>在 <code>package.json</code> 中也是如此，如下方式定义 <code>npm script</code> 是不正确的：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;postinstall&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myInstall.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这是因为 Windows 无法理解 <code>myinstall.js</code> 中的 Shebang ，并且不知道如何使用 <code>node</code> 解释器运行它。</p> <p>相反，请使用如下方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;postinstall&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node myInstall.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="不同的-shell-解释器"><a href="#不同的-shell-解释器" class="header-anchor">#</a> 不同的 shell 解释器</h4> <p>并不是所有的字符在不同的 shell 解释器都能得到相同的处理。</p> <p>例如， Windows 的命令提示符不会像 bash shell 那样将单引号当做双引号，因此它不知道单引号内的所有字符属于同一个字符串组，这会导致错误。</p> <p>下面的命令会导致在 Windows 环境下失效：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier-standard '**/*.js'&quot;</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><p>应该按照如下方式：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier-standard \&quot;**/*.js\&quot;&quot;</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><h4 id="避免手动连接路径"><a href="#避免手动连接路径" class="header-anchor">#</a> 避免手动连接路径</h4> <p>不同平台会使用不同的路径连接符，当通过手动连接它们时，会导致程序不能在不同的平台之前相互操作。</p> <p>让我们看看一个不好的案例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myPath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/../bin/myBin.js</span><span class="token template-punctuation string">`</span></span>
</code></pre></div><p>它使用的是正斜杠，但是 Windows 上是使用反斜杠作为路径的分割符。所以我们不要通过手动的方式构建文件系统路径，而是使用 Node.js 的路径模块:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token string">'bin'</span><span class="token punctuation">,</span> <span class="token string">'myBin.js'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="避免使用分号链接命令"><a href="#避免使用分号链接命令" class="header-anchor">#</a> 避免使用分号链接命令</h4> <p>我们在 Linux 上一般都使用分号来顺序链接要运行的命令，例如：<code>cd /tmp;ls</code>。但是，在 Windows 上执行相同的操作会失败。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> process <span class="token operator">=</span> childProcess<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cliExecPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cliExecPath2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><p>我们可以使用 <code>&amp;&amp;</code> 或者 <code>||</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> process <span class="token operator">=</span> childProcess<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cliExecPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> || </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cliExecPath2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-4-允许环境覆盖"><a href="#_3-4-允许环境覆盖" class="header-anchor">#</a> 3.4 允许环境覆盖</h3> <p>✅ <strong>正确：</strong> 允许从环境变量中读取配置，并且当它与命令行参数冲突时，允许环境变量被覆盖。</p> <p>❌ <strong>错误：</strong> 尽量不要使用自定义配置。</p> <p>➡️ <strong>细节：</strong></p> <p>使用环境变量调整配置，这是许多工具中用于修改 CLI 工具行为的常用方法。</p> <p>当命令行参数和环境变量都配置相同的设置时，应该给环境变量一个优先级来覆盖该设置。</p> <h2 id="_4-易用性"><a href="#_4-易用性" class="header-anchor">#</a> 4 易用性</h2> <p>本节将介绍，如何在用户缺乏开发者设计工具所需环境的情况下，更加容易地使用 Node.js CLI。</p> <h3 id="_4-1-允许环境覆盖"><a href="#_4-1-允许环境覆盖" class="header-anchor">#</a> 4.1 允许环境覆盖</h3> <p>✅ <strong>正确：</strong> 为 CLI 创建一个 docker 镜像，并将其发布到Docker Hub之类的公共仓库中，以便没有 Node.js 环境的用户可以使用它。</p> <p>❌ <strong>错误：</strong> 没有 Node.js 环境的用户将没有 npm 或 npx ，因此将无法运行您的 CLI 工具。</p> <p>➡️ <strong>细节：</strong></p> <p>从 npm 仓库中下载 Node.js CLI 工具通常将使用 Node.js 工具链（例如 npm 或 npx）来完成。这在JavaScript 和 Node.js 开发者中很容易完成。</p> <p>但是，如果您将 CLI 程序提供给大众使用，而不管他们是否熟悉 JavaScript 或该工具是否可用，那么将限制 CLI 程序仅以 npm 仓库形式的安装分发。如果您的 CLI 工具打算在CI环境中使用，则可能还需要安装那些与Node.js 相关的工具链依赖项。</p> <p>打包和分发可执行文件的方式有很多，将预先绑定了 CLI 工具的Docker容器进行容器化，这是一种容易使用方法并且不需要太多依赖关系（除了需要 Docker 环境之外）。</p> <h3 id="_4-2-优雅降级"><a href="#_4-2-优雅降级" class="header-anchor">#</a> 4.2 优雅降级</h3> <p>✅ <strong>正确：</strong> 在用户不受支持的环境中提供没有彩色和丰富交互的输出，比如跳过某些交互直接提供 JSON 格式的输出。</p> <p>❌ <strong>错误：</strong> 对于不受支持的终端用户，使用终端交互可能会显著降低最终用户体验，并阻止他们使用您的 CLI 工具。</p> <p>➡️ <strong>细节：</strong></p> <p>对于那些拥有丰富交互形式的终端的用户来说，彩色输出、ascii图表、终端动画会带来很好的用户体验，但是对于没有这些特性的终端用户来说，它可能会显示一下乱码或者完全无法操作。</p> <p>要使终端不受支持的用户正确使用您的 CLI 工具，您有如下选择:</p> <ul><li><p>自动检测终端能力，并在运行时评估是否对 CLI 的交互性进行降级；</p></li> <li><p>为用户提供一个选项来显式地进行降级，例如通过提供一个 <code>--json</code> 命令行参数来强制输出原始数据。</p></li></ul> <h3 id="_4-3-node-js-版本兼容"><a href="#_4-3-node-js-版本兼容" class="header-anchor">#</a> 4.3 Node.js 版本兼容</h3> <p>✅ <strong>正确：</strong> 支持目前还在维护的 <a href="https://nodejs.org/en/about/releases" target="_blank" rel="noopener noreferrer">Node.js 版本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <p>❌ <strong>错误：</strong> 试图与不受支持的Node.js版本保持兼容的代码库将很难维护，并且会失去使用语言新特性的有点。</p> <p>➡️ <strong>细节：</strong></p> <p>有时可能需要专门针对缺少新的 ECAMScript 特性的旧 Node.js 版本兼容。例如，如果您正在构建一个主要面向DevOps 的Node.js CLI，那么他们可能没有一个理想的 Node.js 环境或者是最新的 runtime。比如，Debian Stretch (oldstable) 附带就是 <a href="https://packages.debian.org/search?suite=default&amp;section=all&amp;arch=any&amp;searchon=names&amp;keywords=nodejs" target="_blank" rel="noopener noreferrer">Node.js 8.11.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.。</p> <p>如果你的需要兼容旧版本的 Node. js 如 Node. js 8、6、4，最好是使用 Babel 之类的编译器来确保生成的代码与V8 JavaScript 引擎的版本兼容，并与这些版本附带的Node.js runtime 兼容。</p> <p>绝对不要因此简化你的代码，来使用一些旧的 ECMAScript 语言规范，因为这会产生代码维护相关的问题。</p> <h3 id="_4-4-自动检测-node-js-runtime"><a href="#_4-4-自动检测-node-js-runtime" class="header-anchor">#</a> 4.4 自动检测 Node.js runtime</h3> <p>✅ <strong>正确：</strong> 在 Shebang 声明中使用与安装位置无关的引用，该引用可根据运行时环境自动定位 Node.js run</p> <p>time。</p> <p>❌ <strong>错误：</strong> 硬编码 Node.js runtime 位置，如 <code>#!/usr/local/bin/node</code> ，仅特定于您自己的环境，这可能使 CLI 工具在其他 Node.js 安装目录不同的环境中无法工作。</p> <p>➡️ <strong>细节：</strong></p> <p>首先在 <code>cli.js</code> 文件的顶部添加 <code>#!/usr/local/bin/node</code>，然后通过 <code>node cli.js</code> 来启动 Node.js CLI，这是一个容易的开始。但是，这是一种有缺陷的方法，因为其他用户的环境无法保证 <code>node</code> 可执行文件的位置。</p> <p>我们可以将 <code>#!/usr/bin/env node</code> 作为最佳实践，但是这仍然假设 Node.js runtime 是被 bin/node 引用，而不是 bin/nodejs 或其他。</p> <h2 id="_5-测试"><a href="#_5-测试" class="header-anchor">#</a> 5 测试</h2> <h3 id="_5-1-不要信任语言环境"><a href="#_5-1-不要信任语言环境" class="header-anchor">#</a> 5.1 不要信任语言环境</h3> <p>✅ <strong>正确：</strong> 不要假定输出文本与您声明的字符串等效，因为测试可能在与您的语言环境不同，比如在非英语环境的系统上运行。</p> <p>❌ <strong>错误：</strong> 当开发人员在非英语语言环境的系统上进行测试时，开发人员将遇到测试失败。</p> <p>➡️ <strong>细节：</strong></p> <p>当您运行 CLI 并解析输出来测试 CLI 时，您可能倾向于使用  grep  命令，以确保某些字符存在于输出中，例如在不带参数的情况下运行 CLI 时：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token function">execSync</span><span class="token punctuation">(</span>cli<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">contain</span><span class="token punctuation">(</span><span class="token string">&quot;Examples:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果在非英语的语言环境中运行测试，并且 CLI 参数解析库支持自动检测语言环境并采用该语言环境，则输出从 <code>Examples</code> 转换成了 “语言环境” 的语言，测试将失败。</p> <h2 id="_6-错误"><a href="#_6-错误" class="header-anchor">#</a> 6 错误</h2> <h3 id="_6-1-错误信息"><a href="#_6-1-错误信息" class="header-anchor">#</a> 6.1 错误信息</h3> <p>✅ <strong>正确：</strong> 在展示错误信息时，提供可以在项目文档中查找的可跟踪错误的代码，从而简化错误消息的排除。</p> <p>❌ <strong>错误：</strong> 一般的错误消息往往模棱两可，用户很难搜索解决方案。</p> <p>➡️ <strong>细节：</strong></p> <p>返回错误消息时，请确保它们包含特定的错误代码，以便以后查阅。与HTTP状态代码非常相似，因此 CLI 工具需要命名或编码错误。</p> <p>例如：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ my-cli-tool <span class="token parameter variable">--doSomething</span>

Error <span class="token punctuation">(</span>E4002<span class="token punctuation">)</span>: please provide an API token via environment variables
</code></pre></div><h3 id="_6-2-可行的错误"><a href="#_6-2-可行的错误" class="header-anchor">#</a> 6.2 可行的错误</h3> <p>✅ <strong>正确：</strong> 错误消息应告诉用户解决方案是什么，而不是仅仅提示这里存在错误。</p> <p>❌ <strong>错误：</strong> 面对错误消息，如果没有任何解决错误的提示，则用户可能无法成功使用 CLI。</p> <p>➡️ <strong>细节：</strong></p> <p>例如：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ my-cli-tool <span class="token parameter variable">--doSomething</span>

Error <span class="token punctuation">(</span>E4002<span class="token punctuation">)</span>: please provide an API token via environment variables
</code></pre></div><h3 id="_6-3-提供调试模式"><a href="#_6-3-提供调试模式" class="header-anchor">#</a> 6.3 提供调试模式</h3> <p>✅ <strong>正确：</strong> 如果高级用户需要诊断问题，则给他们提供更详细的信息</p> <p>❌ <strong>错误：</strong> 不要关闭调试功能。因为只是从用户那里收集反馈，并让他们查明错误原因将特别困难。</p> <p>➡️ <strong>细节：</strong></p> <p>使用环境变量或命令行参数来设置调试模式并打开详细输出信息。在代码中有意义的地方，植入调试消息，以帮助用户和维护者理解程序，输入和输出以及其他使解决问题变得容易的信息。</p> <p>参考开源软件包：</p> <ul><li><a href="https://www.npmjs.com/package/debug" target="_blank" rel="noopener noreferrer">debug<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <hr> <h2 id="作者"><a href="#作者" class="header-anchor">#</a> 作者</h2> <p><strong>Node.js CLI Apps Best Practices</strong> © <a href="https://github.com/lirantal" target="_blank" rel="noopener noreferrer">Liran Tal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Released under <a href="https://github.com/lirantal/nodejs-cli-apps-best-practices/blob/master/LICENSE" target="_blank" rel="noopener noreferrer">CC BY-SA 4.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> License.</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间: </span> <span class="time">10/12/2022, 2:41:00 AM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-ac050c62><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#为什么写这篇文章" class="sidebar-link reco-side-为什么写这篇文章" data-v-ac050c62>为什么写这篇文章？</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#特性" class="sidebar-link reco-side-特性" data-v-ac050c62>特性：</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#为什么是我" class="sidebar-link reco-side-为什么是我" data-v-ac050c62>为什么是我？</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-命令行的经验" class="sidebar-link reco-side-_1-命令行的经验" data-v-ac050c62>1 命令行的经验</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-1-尊重-posix" class="sidebar-link reco-side-_1-1-尊重-posix" data-v-ac050c62>1.1 尊重 POSIX</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-2-构建友好的-cli" class="sidebar-link reco-side-_1-2-构建友好的-cli" data-v-ac050c62>1.2 构建友好的 CLI</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-3-有状态的数据" class="sidebar-link reco-side-_1-3-有状态的数据" data-v-ac050c62>1.3 有状态的数据</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-4-提供多彩的体验" class="sidebar-link reco-side-_1-4-提供多彩的体验" data-v-ac050c62>1.4 提供多彩的体验</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-5-丰富的交互" class="sidebar-link reco-side-_1-5-丰富的交互" data-v-ac050c62>1.5 丰富的交互</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-6-无处不在的超链接" class="sidebar-link reco-side-_1-6-无处不在的超链接" data-v-ac050c62>1.6 无处不在的超链接</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_1-7-零配置" class="sidebar-link reco-side-_1-7-零配置" data-v-ac050c62>1.7 零配置</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_2-发布" class="sidebar-link reco-side-_2-发布" data-v-ac050c62>2 发布</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_2-1-最小化的依赖" class="sidebar-link reco-side-_2-1-最小化的依赖" data-v-ac050c62>2.1 最小化的依赖</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_2-2-使用文件锁" class="sidebar-link reco-side-_2-2-使用文件锁" data-v-ac050c62>2.2 使用文件锁</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_3-通用性" class="sidebar-link reco-side-_3-通用性" data-v-ac050c62>3 通用性</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_3-1-接受-stdin-作为输入" class="sidebar-link reco-side-_3-1-接受-stdin-作为输入" data-v-ac050c62>3.1 接受 STDIN 作为输入</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_3-2-结构化输出" class="sidebar-link reco-side-_3-2-结构化输出" data-v-ac050c62>3.2 结构化输出</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_3-3-跨平台" class="sidebar-link reco-side-_3-3-跨平台" data-v-ac050c62>3.3 跨平台</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_3-4-允许环境覆盖" class="sidebar-link reco-side-_3-4-允许环境覆盖" data-v-ac050c62>3.4 允许环境覆盖</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_4-易用性" class="sidebar-link reco-side-_4-易用性" data-v-ac050c62>4 易用性</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_4-1-允许环境覆盖" class="sidebar-link reco-side-_4-1-允许环境覆盖" data-v-ac050c62>4.1 允许环境覆盖</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_4-2-优雅降级" class="sidebar-link reco-side-_4-2-优雅降级" data-v-ac050c62>4.2 优雅降级</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_4-3-node-js-版本兼容" class="sidebar-link reco-side-_4-3-node-js-版本兼容" data-v-ac050c62>4.3 Node.js 版本兼容</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_4-4-自动检测-node-js-runtime" class="sidebar-link reco-side-_4-4-自动检测-node-js-runtime" data-v-ac050c62>4.4 自动检测 Node.js runtime</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_5-测试" class="sidebar-link reco-side-_5-测试" data-v-ac050c62>5 测试</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_5-1-不要信任语言环境" class="sidebar-link reco-side-_5-1-不要信任语言环境" data-v-ac050c62>5.1 不要信任语言环境</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_6-错误" class="sidebar-link reco-side-_6-错误" data-v-ac050c62>6 错误</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_6-1-错误信息" class="sidebar-link reco-side-_6-1-错误信息" data-v-ac050c62>6.1 错误信息</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_6-2-可行的错误" class="sidebar-link reco-side-_6-2-可行的错误" data-v-ac050c62>6.2 可行的错误</a></li><li class="level-3" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#_6-3-提供调试模式" class="sidebar-link reco-side-_6-3-提供调试模式" data-v-ac050c62>6.3 提供调试模式</a></li><li class="level-2" data-v-ac050c62><a href="/posts/2020/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Node.js%20CLI%20%E5%B7%A5%E5%85%B7%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html#作者" class="sidebar-link reco-side-作者" data-v-ac050c62>作者</a></li></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.dd3d10c5.js" defer></script><script src="/assets/js/3.507ff108.js" defer></script><script src="/assets/js/1.a547ec77.js" defer></script><script src="/assets/js/56.9fc2cca2.js" defer></script>
  </body>
</html>
